SQL> REM SET OPERATOR
SQL> 
SQL> REM SET OPERATORS : 1 UNION ALL 2 UNION 3 INTERSECT 4 MINUS
SQL> 
SQL> 
SQL> REM SET OPERATORS ARE USED TO MAKE COMPOUND QUERY.
SQL> 
SQL> 
SQL> REM SYNTAX COMPOUND QUERY : SELECT ... FROM ... WHERE ... GROUP BY / HAVING     SET OPERATOR   SELECT ... FROM ... WHERE ... GROUP BY / HAVING     ORDER BY ...;
SQL> 
SQL> REM RESULT SET : NO. OF ROWS WHICH WE GET AS RESULT OF ANY SELECT STATEMENT.
SQL> 
SQL> 
SQL> REM SET OPERATORS ARE USED TO COMBINE TWO RESULT SETS.
SQL> 
SQL> 
SQL> REM SET OPERATORS ARE USED TO CLUB VERTICALLY TWO RESULT SETS.
SQL> 
SQL> 
SQL> REM RESULT SET 1 : A  C  B  C  B  D  E
SQL> 
SQL> REM RESULT SET 2 : G  B  H  G  I
SQL> 
SQL> 
SQL> REM UNION ALL : A  C  B  C  B  D  E  G  B  H  G  I
SQL> 
SQL> REN UNION : A B C D E G H I
SP2-0734: unknown command beginning "REN UNION ..." - rest of line ignored.
SQL> 
SQL> REM UNION : A B C D E G H I
SQL> 
SQL> 
SQL> REM INTERSECT : B
SQL> 
SQL> 
SQL> REM MINUS ( RS1 - RS2 ) : A C D E
SQL> 
SQL> REM MINUS ( RS2 - RS1 ) : G H I
SQL> 
SQL> 
SQL> 
SQL> 
SQL> REM UNION ALL : IT WILL SIMPLY CLUB BOTH THE RESULT VERTICALLY.
SQL> 
SQL> REM REMAINING 3 SET OPERATORS PERFORM TWO COMMON TASKS : 1 IT REMOVES DUPLICATE ROWS 2 IT SORTS RESULT IN ASCENDING ORDER
SQL> 
SQL> 
SQL> REM UNION : IT WILL PERFORM ONLY ABOVE TWO COMMON TASKS.
SQL> 
SQL> REM INTERSECT : 1 IT WILL PERFORM ABOVE TWO COMMON TASKS. 2 IT WILL RETURN ONLY ONLY THOSE ROWS WHICH ARE COMMON TO BOTH RESULT SETS.
SQL> 
SQL> REM MINUS : 1 IT WILL PERFORM ABOVE TWO COMMON TASKS. 2 IT WILL REMOVE ALL COMMON ROWS FROM FIRST RESULT SET.
SQL> 
SQL> 
SQL> REM THERE ARE SOME PRE-REQUISITES FOR USING SET OPERATORS
SQL> 
SQL> REM 1 NO. OF ITEMS IN SELECT MUST BE SAME FOR ALL STATEMENTS
SQL> 
SQL> REM 2 WE MAY USE NULL OR ANY LITERAL VALUE INSTEAD TO MAKE THEM SAME IN NUMBERS.
SQL> 
SQL> REM 3 DATA TYPES OF CORRESPONDING ITEMS IN ALL SELECT SHOULD MATCH.
SQL> 
SQL> REM 4 IF DATA TYPES ARE NOT MATCHING, WE CAN EXPLICITLY CONVERT THEM USING CONVERSION FUNCTION.
SQL> 
SQL> REM 5 ORDER BY CLAUS IS AVAILABLE ONCE PER COMPOUND STATEMENT (A STATEMENT WITH SET OPERATOR)
SQL> 
SQL> REM 6 ORDER BY CLAUSE IS PART OF FIRST/MAIN STATEMENT, BUT IT IS PLACED AT THE END OF COMPOUND STATEMENT.
SQL> 
SQL> REM 7 COLUMN ALIAS OF FIRST STATEMENT WILL BE DISPLAYED/USED.
SQL> 
SQL> REM 8 IF WE USE COLUMN ALIAS IN ANY OTHER STATEMENT, IT WILL BE SILENTLY IGNORED.
SQL> 
SQL> REM 9 IF ORDER BY CLAUSE IS NOT PLACED PROPERLY, IT WILL RAISE ERROR.
SQL> 
SQL> 
SQL> 
SQL> REM UNION ALL EXAMPLES
SQL> 
SQL> SELECT JOB FROM MPSEMP;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
PRESIDENT                                                                                                                                                                                                                                                                                                   
MANAGER                                                                                                                                                                                                                                                                                                     
MANAGER                                                                                                                                                                                                                                                                                                     
ANALYST                                                                                                                                                                                                                                                                                                     
MANAGER                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
ANALYST                                                                                                                                                                                                                                                                                                     
SALESMAN                                                                                                                                                                                                                                                                                                    
CLERK                                                                                                                                                                                                                                                                                                       
CLERK                                                                                                                                                                                                                                                                                                       
CLERK                                                                                                                                                                                                                                                                                                       

14 rows selected.

SQL> SELECT * FROM MPSEMP;

     EMPNO ENAME      JOB               MGR HIREDATE         SAL       COMM     DEPTNO                                                                                                                                                                                                                      
---------- ---------- ---------- ---------- --------- ---------- ---------- ----------                                                                                                                                                                                                                      
      7839 KING       PRESIDENT             17-NOV-81       5000                    10                                                                                                                                                                                                                      
      7782 CLARK      MANAGER          7839 09-JUN-81       2450                    10                                                                                                                                                                                                                      
      7566 JONES      MANAGER          7839 02-APR-81       2975                    20                                                                                                                                                                                                                      
      7902 FORD       ANALYST          7566 04-DEC-81                  3000         20                                                                                                                                                                                                                      
      7698 BLAKE      MANAGER          7839 01-MAY-91       2850                    30                                                                                                                                                                                                                      
      7369 SMITH      CLERK            7902 17-DEC-80        800                    20                                                                                                                                                                                                                      
      7499 ALLEN      SALESMAN         7698 20-FEB-81       1600        300         30                                                                                                                                                                                                                      
      7521 WARD       SALESMAN         7698 22-FEB-81       1250        500         30                                                                                                                                                                                                                      
      7654 MARTIN     SALESMAN         7698 28-SEP-81       1250       1400         30                                                                                                                                                                                                                      
      7788 SCOTT      ANALYST          7566 09-DEC-82       3000                    20                                                                                                                                                                                                                      
      7844 TURNER     SALESMAN         7698 08-SEP-81       1500          0         30                                                                                                                                                                                                                      
      7876 ADAMS      CLERK            7788 12-JAN-89                  1100         20                                                                                                                                                                                                                      
      7900 JAMES      CLERK            7698 03-DEC-81                   950         30                                                                                                                                                                                                                      
      7934 MILLER     CLERK            7782 23-JAN-82       1300                    10                                                                                                                                                                                                                      

14 rows selected.

SQL> SELECT * FROM EMPLOYEES;

EMPLOYEE_ID FIRST_NAME           LAST_NAME                 EMAIL                     PHONE_NUMBER         HIRE_DATE JOB_ID         SALARY COMMISSION_PCT MANAGER_ID DEPARTMENT_ID                                                                                                                           
----------- -------------------- ------------------------- ------------------------- -------------------- --------- ---------- ---------- -------------- ---------- -------------                                                                                                                           
        100 Steven               King                      SKING                     515.123.4567         17-JUL-87 AD_PRES         24000                                      90                                                                                                                           
        101 Neena                Kochhar                   NKOCHHAR                  515.123.4568         21-SEP-89 AD_VP           17000                       100            90                                                                                                                           
        102 Lex                  De Haan                   LDEHAAN                   515.123.4569         13-JAN-93 AD_VP           17000                       100            90                                                                                                                           
        103 Alexander            Hunold                    AHUNOLD                   590.423.4567         03-JAN-90 IT_PROG          9000                       102            60                                                                                                                           
        104 Bruce                Ernst                     BERNST                    590.423.4568         21-MAY-91 IT_PROG          6000                       103            60                                                                                                                           
        107 Diana                Lorentz                   DLORENTZ                  590.423.5567         07-FEB-99 IT_PROG          4200                       103            60                                                                                                                           
        124 Kevin                Mourgos                   KMOURGOS                  650.123.5234         16-NOV-99 ST_MAN           5800                       100            50                                                                                                                           
        141 Trenna               Rajs                      TRAJS                     650.121.8009         17-OCT-95 ST_CLERK         3500                       124            50                                                                                                                           
        142 Curtis               Davies                    CDAVIES                   650.121.2994         29-JAN-97 ST_CLERK         3100                       124            50                                                                                                                           
        143 Randall              Matos                     RMATOS                    650.121.2874         15-MAR-98 ST_CLERK         2600                       124            50                                                                                                                           
        144 Peter                Vargas                    PVARGAS                   650.121.2004         09-JUL-98 ST_CLERK         2500                       124            50                                                                                                                           
        149 Eleni                Zlotkey                   EZLOTKEY                  011.44.1344.429018   29-JAN-00 SA_MAN          10500             .2        100            80                                                                                                                           
        174 Ellen                Abel                      EABEL                     011.44.1644.429267   11-MAY-96 SA_REP          11000             .3        149            80                                                                                                                           
        176 Jonathon             Taylor                    JTAYLOR                   011.44.1644.429265   24-MAR-98 SA_REP           8600             .3        149            80                                                                                                                           
        178 Kimerely             Grant                     KGRANT                    011.44.1644.429263   24-MAY-99 SA_REP           7000            .15        149                                                                                                                                         
        200 Jennifer             Whalen                    JWAHLEN                   515.123.4444         17-SEP-87 AD_ASST          4400                       101            10                                                                                                                           
        201 Michael              Hartstein                 MHARTSTE                  515.123.5555         17-FEB-96 MK_MAN          13000                       100            20                                                                                                                           
        202 Pat                  Fay                       PFAY                      603.123.6666         17-AUG-97 MK_REP           6000                       201            20                                                                                                                           
        205 Shelley              Higgins                   SHIGGINS                  515.123.8080         07-JUN-94 AC_MGR          12000                       101           110                                                                                                                           
        206 William              Gietz                     WGIETZ                    515.123.8181         07-JUN-94 AC_ACCOUNT       8300                       205           110                                                                                                                           

20 rows selected.

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
PRESIDENT                                                                                                                                                                                                                                                                                                   
MANAGER                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 20;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
MANAGER                                                                                                                                                                                                                                                                                                     
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 30;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
MANAGER                                                                                                                                                                                                                                                                                                     
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
CLERK                                                                                                                                                                                                                                                                                                       

6 rows selected.

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT JOB FROM MPSEMP WHERE DEPTNO = 20;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
PRESIDENT                                                                                                                                                                                                                                                                                                   
MANAGER                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
MANAGER                                                                                                                                                                                                                                                                                                     
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       

8 rows selected.

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10
  2  UNION
  3  SELECT JOB FROM MPSEMP WHERE DEPTNO = 20;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
MANAGER                                                                                                                                                                                                                                                                                                     
PRESIDENT                                                                                                                                                                                                                                                                                                   

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
PRESIDENT                                                                                                                                                                                                                                                                                                   
MANAGER                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 20;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
MANAGER                                                                                                                                                                                                                                                                                                     
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       

SQL> 
SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10
  2  INTERSECT
  3  SELECT JOB FROM MPSEMP WHERE DEPTNO = 20;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
CLERK                                                                                                                                                                                                                                                                                                       
MANAGER                                                                                                                                                                                                                                                                                                     

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10
  2  MINUS
  3  SELECT JOB FROM MPSEMP WHERE DEPTNO = 20;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
PRESIDENT                                                                                                                                                                                                                                                                                                   

SQL> REM MINUS : IT WILL RETURN UNCOMMON ROWS OF RESULT SET 1.
SQL> 
SQL> 
SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 20
  2  MINUS
  3  SELECT JOB FROM MPSEMP WHERE DEPTNO = 10;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
ANALYST                                                                                                                                                                                                                                                                                                     

SQL> SELECT JOB FROM MPSEMP;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
PRESIDENT                                                                                                                                                                                                                                                                                                   
MANAGER                                                                                                                                                                                                                                                                                                     
MANAGER                                                                                                                                                                                                                                                                                                     
ANALYST                                                                                                                                                                                                                                                                                                     
MANAGER                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
ANALYST                                                                                                                                                                                                                                                                                                     
SALESMAN                                                                                                                                                                                                                                                                                                    
CLERK                                                                                                                                                                                                                                                                                                       
CLERK                                                                                                                                                                                                                                                                                                       
CLERK                                                                                                                                                                                                                                                                                                       

14 rows selected.

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
PRESIDENT                                                                                                                                                                                                                                                                                                   
MANAGER                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 20;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
MANAGER                                                                                                                                                                                                                                                                                                     
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 30;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
MANAGER                                                                                                                                                                                                                                                                                                     
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
CLERK                                                                                                                                                                                                                                                                                                       

6 rows selected.

SQL> 
SQL> REM 10 UNION ALL 20 UNION ALL 30 : 1 ROW COUNT : 14 : 2 PRESIDENT MANAGER CLERK MANAGER ANALYST CLERK ANALYST CLERK MANAGER SALESMAN SALESMAN SALESMAN SALESMAN CLERK
SQL> 
SQL> REM 10 UNION 20 UNION 30 : 1 ROW COUNT : 5  : 2 RESULT ROWS : ANALYST CLERK MANAGER PROESIDENT SALESMAN
SQL> 
SQL> REM 10 INTERSECT 20 INTERSECT 30 : 1 ROW COUNT : 2  : 2 RESULT ROWS : CLERK MANAGER
SQL> 
SQL> REM 10 MINUS 20 MINUS 30 : 1 ROW COUNT : 1  : 2 RESULT ROWS : PRESIDENT
SQL> 
SQL> 
SQL> REM UNION ALL : ALL ROWS OF BOTH RESULT SET
SQL> 
SQL> REM UNION : DISTINCT ROWS OF BOTH RESULT SET
SQL> 
SQL> REM INTERSECT : COMMON DISTINCT ROWS OF BOTH RESULT SET
SQL> 
SQL> REM MINUS : UNCOMMON DISTINCT ROWS OF FIRST RESULT SET
SQL> 
SQL> 
SQL> 
SQL> REM EFFECTS ON RESULT SETS IF WE CHANGE THE POSITION OF QUERY
SQL> 
SQL> REM 1 UNION ALL : NO. OF ROWS WILL REMAIN SAME, BUT ROWS ORDER MAY BE CHANGED
SQL> 
SQL> REM 2 UNION : NO CHANGE
SQL> 
SQL> REM 3 INTERSECT : NO CHANGE
SQL> 
SQL> REM 4 MINUS : IF WE CHANGE FIRST/MAIN QUERY THEN RESULT SET WILL BE AFFECTED.
SQL> 
SQL> 
SQL> 
SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
PRESIDENT                                                                                                                                                                                                                                                                                                   
MANAGER                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 20;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
MANAGER                                                                                                                                                                                                                                                                                                     
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 30;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
MANAGER                                                                                                                                                                                                                                                                                                     
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
CLERK                                                                                                                                                                                                                                                                                                       

6 rows selected.

SQL> REM 10 UNION ALL 2 UNION 30 :
SQL> 
SQL> REM DEFAULT EXECUTION PRECEDENCE IS FROM TOP TO BOTTOM , LEFT TO RIGHT
SQL> 
SQL> 
SQL> REM DEFAULT EXECUTION PRECEDENCE IS FROM LEFT TO RIGHT , TOP TO BOTTOM
SQL> 
SQL> 
SQL> REM 10 UNION ALL 20 UNION 30 :
SQL> 
SQL> REM 10 UNION 20 UNION ALL 30 :
SQL> 
SQL> 
SQL> 
SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT JOB FROM MPSEMP WHERE DEPTNO = 20
  4  UNION
  5  SELECT JOB FROM MPSEMP WHERE DEPTNO = 30;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
MANAGER                                                                                                                                                                                                                                                                                                     
PRESIDENT                                                                                                                                                                                                                                                                                                   
SALESMAN                                                                                                                                                                                                                                                                                                    

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10
  2  UNION
  3  SELECT JOB FROM MPSEMP WHERE DEPTNO = 20
  4  UNION ALL
  5  SELECT JOB FROM MPSEMP WHERE DEPTNO = 30;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
MANAGER                                                                                                                                                                                                                                                                                                     
PRESIDENT                                                                                                                                                                                                                                                                                                   
MANAGER                                                                                                                                                                                                                                                                                                     
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
SALESMAN                                                                                                                                                                                                                                                                                                    
CLERK                                                                                                                                                                                                                                                                                                       

10 rows selected.

SQL> REM WE CAN CHANGE THE PRECEDENCE OF EXECUTION USING ( )
SQL> 
SQL> 
SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT JOB FROM MPSEMP WHERE DEPTNO = 20
  4  UNION
  5  SELECT JOB FROM MPSEMP WHERE DEPTNO = 30
  6  
SQL> 
SQL> ED
Wrote file afiedt.buf

  1  SELECT JOB FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  (SELECT JOB FROM MPSEMP WHERE DEPTNO = 20
  4  UNION
  5* SELECT JOB FROM MPSEMP WHERE DEPTNO = 30)
SQL> 
SQL> 
SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT JOB FROM MPSEMP WHERE DEPTNO = 20
  4  UNION
  5  SELECT JOB FROM MPSEMP WHERE DEPTNO = 30;

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
MANAGER                                                                                                                                                                                                                                                                                                     
PRESIDENT                                                                                                                                                                                                                                                                                                   
SALESMAN                                                                                                                                                                                                                                                                                                    

SQL> SELECT JOB FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  (SELECT JOB FROM MPSEMP WHERE DEPTNO = 20
  4  UNION
  5  SELECT JOB FROM MPSEMP WHERE DEPTNO = 30);

JOB                                                                                                                                                                                                                                                                                                         
----------                                                                                                                                                                                                                                                                                                  
PRESIDENT                                                                                                                                                                                                                                                                                                   
MANAGER                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
ANALYST                                                                                                                                                                                                                                                                                                     
CLERK                                                                                                                                                                                                                                                                                                       
MANAGER                                                                                                                                                                                                                                                                                                     
SALESMAN                                                                                                                                                                                                                                                                                                    

7 rows selected.

SQL> REM 1 NO. OF ITEMS IN SELECT MUST BE SAME FOR ALL STATEMENTS
SQL> 
SQL> REM 2 WE MAY USE NULL OR ANY LITERAL VALUE INSTEAD TO MAKE THEM SAME IN NUMBERS.
SQL> 
SQL> SELECT DEPTNO , ENAME FROM MPSEMP
  2  UNION ALL
  3  SELECT DEPTNO , ENAME , SAL FROM MPSEMP
  4  
SQL> 
SQL> SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO = 10
  2  
SQL> 
SQL> SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT DEPTNO , ENAME , SALARY FROM MPSEMP WHERE DEPTNO = 20;
SELECT DEPTNO , ENAME , SALARY FROM MPSEMP WHERE DEPTNO = 20
                        *
ERROR at line 3:
ORA-00904: "SALARY": invalid identifier 


SQL> SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT DEPTNO , ENAME , SAL FROM MPSEMP WHERE DEPTNO = 20;
SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO = 10
*
ERROR at line 1:
ORA-01789: query block has incorrect number of result columns 


SQL> SELECT DEPTNO , ENAME , NULL FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT DEPTNO , ENAME , SAL FROM MPSEMP WHERE DEPTNO = 20;

    DEPTNO ENAME            NULL                                                                                                                                                                                                                                                                            
---------- ---------- ----------                                                                                                                                                                                                                                                                            
        10 KING                                                                                                                                                                                                                                                                                             
        10 CLARK                                                                                                                                                                                                                                                                                            
        10 MILLER                                                                                                                                                                                                                                                                                           
        20 JONES            2975                                                                                                                                                                                                                                                                            
        20 FORD                                                                                                                                                                                                                                                                                             
        20 SMITH             800                                                                                                                                                                                                                                                                            
        20 SCOTT            3000                                                                                                                                                                                                                                                                            
        20 ADAMS                                                                                                                                                                                                                                                                                            

8 rows selected.

SQL> SELECT DEPTNO , ENAME , 0FROM MPSEMP WHERE DEPTNO = 10
  2  
SQL> SELECT DEPTNO , ENAME , 0 FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT DEPTNO , ENAME , SAL FROM MPSEMP WHERE DEPTNO = 20;

    DEPTNO ENAME               0                                                                                                                                                                                                                                                                            
---------- ---------- ----------                                                                                                                                                                                                                                                                            
        10 KING                0                                                                                                                                                                                                                                                                            
        10 CLARK               0                                                                                                                                                                                                                                                                            
        10 MILLER              0                                                                                                                                                                                                                                                                            
        20 JONES            2975                                                                                                                                                                                                                                                                            
        20 FORD                                                                                                                                                                                                                                                                                             
        20 SMITH             800                                                                                                                                                                                                                                                                            
        20 SCOTT            3000                                                                                                                                                                                                                                                                            
        20 ADAMS                                                                                                                                                                                                                                                                                            

8 rows selected.

SQL> SELECT DEPTNO , ENAME , 12345 FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT DEPTNO , ENAME , SAL FROM MPSEMP WHERE DEPTNO = 20;

    DEPTNO ENAME           12345                                                                                                                                                                                                                                                                            
---------- ---------- ----------                                                                                                                                                                                                                                                                            
        10 KING            12345                                                                                                                                                                                                                                                                            
        10 CLARK           12345                                                                                                                                                                                                                                                                            
        10 MILLER          12345                                                                                                                                                                                                                                                                            
        20 JONES            2975                                                                                                                                                                                                                                                                            
        20 FORD                                                                                                                                                                                                                                                                                             
        20 SMITH             800                                                                                                                                                                                                                                                                            
        20 SCOTT            3000                                                                                                                                                                                                                                                                            
        20 ADAMS                                                                                                                                                                                                                                                                                            

8 rows selected.

SQL> REM 3 DATA TYPES OF CORRESPONDING ITEMS IN ALL SELECT SHOULD MATCH.
SQL> 
SQL> REM 4 IF DATA TYPES ARE NOT MATCHING, WE CAN EXPLICITLY CONVERT THEM USING CONVERSION FUNCTION.
SQL> 
SQL> SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT ENAME , DEPTNO FROM MPSEMP WHERE DEPTNO = 20;
SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO = 10
       *
ERROR at line 1:
ORA-01790: expression must have same datatype as corresponding expression 


SQL> SELECT TO_CHAR(DEPTNO) , ENAME FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT ENAME , TO_CHAR(DEPTNO) FROM MPSEMP WHERE DEPTNO = 20;

TO_CHAR(DEPTNO)                          ENAME                                                                                                                                                                                                                                                              
---------------------------------------- ----------------------------------------                                                                                                                                                                                                                           
10                                       KING                                                                                                                                                                                                                                                               
10                                       CLARK                                                                                                                                                                                                                                                              
10                                       MILLER                                                                                                                                                                                                                                                             
JONES                                    20                                                                                                                                                                                                                                                                 
FORD                                     20                                                                                                                                                                                                                                                                 
SMITH                                    20                                                                                                                                                                                                                                                                 
SCOTT                                    20                                                                                                                                                                                                                                                                 
ADAMS                                    20                                                                                                                                                                                                                                                                 

8 rows selected.

SQL> REM 7 COLUMN ALIAS OF FIRST STATEMENT WILL BE DISPLAYED/USED.
SQL> 
SQL> REM 8 IF WE USE COLUMN ALIAS IN ANY OTHER STATEMENT, IT WILL BE SILENTLY IGNORED.
SQL> 
SQL> SELECT TO_CHAR(DEPTNO) , ENAME FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT ENAME , TO_CHAR(DEPTNO) "HI HELLO" FROM MPSEMP WHERE DEPTNO = 20;

TO_CHAR(DEPTNO)                          ENAME                                                                                                                                                                                                                                                              
---------------------------------------- ----------------------------------------                                                                                                                                                                                                                           
10                                       KING                                                                                                                                                                                                                                                               
10                                       CLARK                                                                                                                                                                                                                                                              
10                                       MILLER                                                                                                                                                                                                                                                             
JONES                                    20                                                                                                                                                                                                                                                                 
FORD                                     20                                                                                                                                                                                                                                                                 
SMITH                                    20                                                                                                                                                                                                                                                                 
SCOTT                                    20                                                                                                                                                                                                                                                                 
ADAMS                                    20                                                                                                                                                                                                                                                                 

8 rows selected.

SQL> SELECT TO_CHAR(DEPTNO) "HI HELLO" , ENAME FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3  SELECT ENAME , TO_CHAR(DEPTNO) "HI HELLO" FROM MPSEMP WHERE DEPTNO = 20;

HI HELLO                                 ENAME                                                                                                                                                                                                                                                              
---------------------------------------- ----------------------------------------                                                                                                                                                                                                                           
10                                       KING                                                                                                                                                                                                                                                               
10                                       CLARK                                                                                                                                                                                                                                                              
10                                       MILLER                                                                                                                                                                                                                                                             
JONES                                    20                                                                                                                                                                                                                                                                 
FORD                                     20                                                                                                                                                                                                                                                                 
SMITH                                    20                                                                                                                                                                                                                                                                 
SCOTT                                    20                                                                                                                                                                                                                                                                 
ADAMS                                    20                                                                                                                                                                                                                                                                 

8 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT TO_CHAR(DEPTNO) "DEPTNO AND ENAME" , ENAME "ENAME AND DEPTNO" FROM MPSEMP WHERE DEPTNO = 10
  2  UNION ALL
  3* SELECT ENAME , TO_CHAR(DEPTNO) FROM MPSEMP WHERE DEPTNO = 20
SQL> /

DEPTNO AND ENAME                         ENAME AND DEPTNO                                                                                                                                                                                                                                                   
---------------------------------------- ----------------------------------------                                                                                                                                                                                                                           
10                                       KING                                                                                                                                                                                                                                                               
10                                       CLARK                                                                                                                                                                                                                                                              
10                                       MILLER                                                                                                                                                                                                                                                             
JONES                                    20                                                                                                                                                                                                                                                                 
FORD                                     20                                                                                                                                                                                                                                                                 
SMITH                                    20                                                                                                                                                                                                                                                                 
SCOTT                                    20                                                                                                                                                                                                                                                                 
ADAMS                                    20                                                                                                                                                                                                                                                                 

8 rows selected.

SQL> REM 5 ORDER BY CLAUS IS AVAILABLE ONCE PER COMPOUND STATEMENT (A STATEMENT WITH SET OPERATOR)
SQL> 
SQL> REM 6 ORDER BY CLAUSE IS PART OF FIRST/MAIN STATEMENT, BUT IT IS PLACED AT THE END OF COMPOUND STATEMENT.
SQL> 
SQL> REM 9 IF ORDER BY CLAUSE IS NOT PLACED PROPERLY, IT WILL RAISE ERROR.
SQL> 
SQL> 
SQL> 
SQL> SELECT DEPTNO , ENAME FROM MPSEMP ORDER BY 2
  2  UNION ALL
  3  SELECT EMPNO , ENAME FROM MPSEMP ORDER BY 1;
UNION ALL
*
ERROR at line 2:
ORA-00933: SQL command not properly ended 


SQL> 
SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO , ENAME FROM MPSEMP ORDER BY 2
  2  UNION ALL
  3* SELECT EMPNO , ENAME FROM MPSEMP
SQL> /
UNION ALL
*
ERROR at line 2:
ORA-00933: SQL command not properly ended 


SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO , ENAME FROM MPSEMP
  2  UNION ALL
  3* SELECT EMPNO , ENAME FROM MPSEMP  ORDER BY 2
SQL> /

    DEPTNO ENAME                                                                                                                                                                                                                                                                                            
---------- ----------                                                                                                                                                                                                                                                                                       
      7876 ADAMS                                                                                                                                                                                                                                                                                            
        20 ADAMS                                                                                                                                                                                                                                                                                            
        30 ALLEN                                                                                                                                                                                                                                                                                            
      7499 ALLEN                                                                                                                                                                                                                                                                                            
        30 BLAKE                                                                                                                                                                                                                                                                                            
      7698 BLAKE                                                                                                                                                                                                                                                                                            
        10 CLARK                                                                                                                                                                                                                                                                                            
      7782 CLARK                                                                                                                                                                                                                                                                                            
      7902 FORD                                                                                                                                                                                                                                                                                             
        20 FORD                                                                                                                                                                                                                                                                                             
      7900 JAMES                                                                                                                                                                                                                                                                                            
        30 JAMES                                                                                                                                                                                                                                                                                            
      7566 JONES                                                                                                                                                                                                                                                                                            
        20 JONES                                                                                                                                                                                                                                                                                            
      7839 KING                                                                                                                                                                                                                                                                                             
        10 KING                                                                                                                                                                                                                                                                                             
        30 MARTIN                                                                                                                                                                                                                                                                                           
      7654 MARTIN                                                                                                                                                                                                                                                                                           
      7934 MILLER                                                                                                                                                                                                                                                                                           
        10 MILLER                                                                                                                                                                                                                                                                                           
        20 SCOTT                                                                                                                                                                                                                                                                                            
      7788 SCOTT                                                                                                                                                                                                                                                                                            
        20 SMITH                                                                                                                                                                                                                                                                                            
      7369 SMITH                                                                                                                                                                                                                                                                                            
        30 TURNER                                                                                                                                                                                                                                                                                           
      7844 TURNER                                                                                                                                                                                                                                                                                           
        30 WARD                                                                                                                                                                                                                                                                                             
      7521 WARD                                                                                                                                                                                                                                                                                             

28 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO 10
  2  UNION ALL
  3* (SELECT EMPNO , ENAME FROM MPSEMP  WHERE SAL > 1500 ORDER BY 2)
SQL> /
SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO 10
                                               *
ERROR at line 1:
ORA-00920: invalid relational operator 


SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO 10
  2  UNION ALL
  3* (SELECT EMPNO , ENAME FROM MPSEMP  WHERE SAL > 1500) ORDER BY 2
SQL> /
SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO 10
                                               *
ERROR at line 1:
ORA-00920: invalid relational operator 


SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO = 10 
  2  UNION ALL
  3* (SELECT EMPNO , ENAME FROM MPSEMP  WHERE SAL > 1500 ORDER BY 2)
SQL> /
(SELECT EMPNO , ENAME FROM MPSEMP  WHERE SAL > 1500 ORDER BY 2)
                                                    *
ERROR at line 3:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO = 10 
  2  UNION ALL
  3* (SELECT EMPNO , ENAME FROM MPSEMP  WHERE SAL > 1500) ORDER BY 2
SQL> /

    DEPTNO ENAME                                                                                                                                                                                                                                                                                            
---------- ----------                                                                                                                                                                                                                                                                                       
      7499 ALLEN                                                                                                                                                                                                                                                                                            
      7698 BLAKE                                                                                                                                                                                                                                                                                            
        10 CLARK                                                                                                                                                                                                                                                                                            
      7782 CLARK                                                                                                                                                                                                                                                                                            
      7566 JONES                                                                                                                                                                                                                                                                                            
        10 KING                                                                                                                                                                                                                                                                                             
      7839 KING                                                                                                                                                                                                                                                                                             
        10 MILLER                                                                                                                                                                                                                                                                                           
      7788 SCOTT                                                                                                                                                                                                                                                                                            

9 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO , ENAME FROM MPSEMP WHERE DEPTNO = 10 
  2  UNION ALL
  3* SELECT EMPNO , ENAME FROM MPSEMP  WHERE SAL > 1500 ORDER BY 2
SQL> /

    DEPTNO ENAME                                                                                                                                                                                                                                                                                            
---------- ----------                                                                                                                                                                                                                                                                                       
      7499 ALLEN                                                                                                                                                                                                                                                                                            
      7698 BLAKE                                                                                                                                                                                                                                                                                            
        10 CLARK                                                                                                                                                                                                                                                                                            
      7782 CLARK                                                                                                                                                                                                                                                                                            
      7566 JONES                                                                                                                                                                                                                                                                                            
        10 KING                                                                                                                                                                                                                                                                                             
      7839 KING                                                                                                                                                                                                                                                                                             
        10 MILLER                                                                                                                                                                                                                                                                                           
      7788 SCOTT                                                                                                                                                                                                                                                                                            

9 rows selected.

SQL> SELECT * FROM MPSSTAFF;

NAME                                                                                                                                                                                                                                                                                                        
----------                                                                                                                                                                                                                                                                                                  
ASHWIN                                                                                                                                                                                                                                                                                                      
SARITA                                                                                                                                                                                                                                                                                                      
BIMAL                                                                                                                                                                                                                                                                                                       

SQL> SELECT * FROM MPSSUBJECT;

NAME                                                                                                                                                                                                                                                                                                        
----------                                                                                                                                                                                                                                                                                                  
TOEFL                                                                                                                                                                                                                                                                                                       
GMAT                                                                                                                                                                                                                                                                                                        
SAT                                                                                                                                                                                                                                                                                                         
GRE                                                                                                                                                                                                                                                                                                         

SQL> SELECT * FROM MPSCANTEACH;

STAFF      SUBJECT                                                                                                                                                                                                                                                                                          
---------- ----------                                                                                                                                                                                                                                                                                       
ASHWIN     TOEFL                                                                                                                                                                                                                                                                                            
ASHWIN     GRE                                                                                                                                                                                                                                                                                              
SARITA     GMAT                                                                                                                                                                                                                                                                                             
BIMAL      SAT                                                                                                                                                                                                                                                                                              

SQL> SELECT * FROM MPSSTAFF CROSS JOIN MPSSUBJECT;

NAME       NAME                                                                                                                                                                                                                                                                                             
---------- ----------                                                                                                                                                                                                                                                                                       
ASHWIN     TOEFL                                                                                                                                                                                                                                                                                            
ASHWIN     GMAT                                                                                                                                                                                                                                                                                             
ASHWIN     SAT                                                                                                                                                                                                                                                                                              
ASHWIN     GRE                                                                                                                                                                                                                                                                                              
SARITA     TOEFL                                                                                                                                                                                                                                                                                            
SARITA     GMAT                                                                                                                                                                                                                                                                                             
SARITA     SAT                                                                                                                                                                                                                                                                                              
SARITA     GRE                                                                                                                                                                                                                                                                                              
BIMAL      TOEFL                                                                                                                                                                                                                                                                                            
BIMAL      GMAT                                                                                                                                                                                                                                                                                             
BIMAL      SAT                                                                                                                                                                                                                                                                                              
BIMAL      GRE                                                                                                                                                                                                                                                                                              

12 rows selected.

SQL> SELECT NAME , NAME FROM MPSSTAFF CROSS JOIN MPSSUBJECT;
SELECT NAME , NAME FROM MPSSTAFF CROSS JOIN MPSSUBJECT
              *
ERROR at line 1:
ORA-00918: column ambiguously defined 


SQL> SELECT MPSSTAFF.NAME , MPSSUBJECT.NAME FROM MPSSTAFF CROSS JOIN MPSSUBJECT;

NAME       NAME                                                                                                                                                                                                                                                                                             
---------- ----------                                                                                                                                                                                                                                                                                       
ASHWIN     TOEFL                                                                                                                                                                                                                                                                                            
ASHWIN     GMAT                                                                                                                                                                                                                                                                                             
ASHWIN     SAT                                                                                                                                                                                                                                                                                              
ASHWIN     GRE                                                                                                                                                                                                                                                                                              
SARITA     TOEFL                                                                                                                                                                                                                                                                                            
SARITA     GMAT                                                                                                                                                                                                                                                                                             
SARITA     SAT                                                                                                                                                                                                                                                                                              
SARITA     GRE                                                                                                                                                                                                                                                                                              
BIMAL      TOEFL                                                                                                                                                                                                                                                                                            
BIMAL      GMAT                                                                                                                                                                                                                                                                                             
BIMAL      SAT                                                                                                                                                                                                                                                                                              
BIMAL      GRE                                                                                                                                                                                                                                                                                              

12 rows selected.

SQL> SELECT T.NAME , B.NAME FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B;

NAME       NAME                                                                                                                                                                                                                                                                                             
---------- ----------                                                                                                                                                                                                                                                                                       
ASHWIN     TOEFL                                                                                                                                                                                                                                                                                            
ASHWIN     GMAT                                                                                                                                                                                                                                                                                             
ASHWIN     SAT                                                                                                                                                                                                                                                                                              
ASHWIN     GRE                                                                                                                                                                                                                                                                                              
SARITA     TOEFL                                                                                                                                                                                                                                                                                            
SARITA     GMAT                                                                                                                                                                                                                                                                                             
SARITA     SAT                                                                                                                                                                                                                                                                                              
SARITA     GRE                                                                                                                                                                                                                                                                                              
BIMAL      TOEFL                                                                                                                                                                                                                                                                                            
BIMAL      GMAT                                                                                                                                                                                                                                                                                             
BIMAL      SAT                                                                                                                                                                                                                                                                                              
BIMAL      GRE                                                                                                                                                                                                                                                                                              

12 rows selected.

SQL> SELECT T.NAME STAFF , B.NAME SUBJECT FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B;

STAFF      SUBJECT                                                                                                                                                                                                                                                                                          
---------- ----------                                                                                                                                                                                                                                                                                       
ASHWIN     TOEFL                                                                                                                                                                                                                                                                                            
ASHWIN     GMAT                                                                                                                                                                                                                                                                                             
ASHWIN     SAT                                                                                                                                                                                                                                                                                              
ASHWIN     GRE                                                                                                                                                                                                                                                                                              
SARITA     TOEFL                                                                                                                                                                                                                                                                                            
SARITA     GMAT                                                                                                                                                                                                                                                                                             
SARITA     SAT                                                                                                                                                                                                                                                                                              
SARITA     GRE                                                                                                                                                                                                                                                                                              
BIMAL      TOEFL                                                                                                                                                                                                                                                                                            
BIMAL      GMAT                                                                                                                                                                                                                                                                                             
BIMAL      SAT                                                                                                                                                                                                                                                                                              
BIMAL      GRE                                                                                                                                                                                                                                                                                              

12 rows selected.

SQL> SELECT T.NAME STAFF , B.NAME SUBJECT FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B
  2  
SQL> SELECT T.NAME STAFF , B.NAME SUBJECT , 'NO' FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B;

STAFF      SUBJECT    'N                                                                                                                                                                                                                                                                                    
---------- ---------- --                                                                                                                                                                                                                                                                                    
ASHWIN     TOEFL      NO                                                                                                                                                                                                                                                                                    
ASHWIN     GMAT       NO                                                                                                                                                                                                                                                                                    
ASHWIN     SAT        NO                                                                                                                                                                                                                                                                                    
ASHWIN     GRE        NO                                                                                                                                                                                                                                                                                    
SARITA     TOEFL      NO                                                                                                                                                                                                                                                                                    
SARITA     GMAT       NO                                                                                                                                                                                                                                                                                    
SARITA     SAT        NO                                                                                                                                                                                                                                                                                    
SARITA     GRE        NO                                                                                                                                                                                                                                                                                    
BIMAL      TOEFL      NO                                                                                                                                                                                                                                                                                    
BIMAL      GMAT       NO                                                                                                                                                                                                                                                                                    
BIMAL      SAT        NO                                                                                                                                                                                                                                                                                    
BIMAL      GRE        NO                                                                                                                                                                                                                                                                                    

12 rows selected.

SQL> SELECT T.NAME STAFF , B.NAME SUBJECT , 'NO' CAN FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B;

STAFF      SUBJECT    CA                                                                                                                                                                                                                                                                                    
---------- ---------- --                                                                                                                                                                                                                                                                                    
ASHWIN     TOEFL      NO                                                                                                                                                                                                                                                                                    
ASHWIN     GMAT       NO                                                                                                                                                                                                                                                                                    
ASHWIN     SAT        NO                                                                                                                                                                                                                                                                                    
ASHWIN     GRE        NO                                                                                                                                                                                                                                                                                    
SARITA     TOEFL      NO                                                                                                                                                                                                                                                                                    
SARITA     GMAT       NO                                                                                                                                                                                                                                                                                    
SARITA     SAT        NO                                                                                                                                                                                                                                                                                    
SARITA     GRE        NO                                                                                                                                                                                                                                                                                    
BIMAL      TOEFL      NO                                                                                                                                                                                                                                                                                    
BIMAL      GMAT       NO                                                                                                                                                                                                                                                                                    
BIMAL      SAT        NO                                                                                                                                                                                                                                                                                    
BIMAL      GRE        NO                                                                                                                                                                                                                                                                                    

12 rows selected.

SQL> SELECT T.NAME STAFF , B.NAME SUBJECT , 'NO ' CAN FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B;

STAFF      SUBJECT    CAN                                                                                                                                                                                                                                                                                   
---------- ---------- ---                                                                                                                                                                                                                                                                                   
ASHWIN     TOEFL      NO                                                                                                                                                                                                                                                                                    
ASHWIN     GMAT       NO                                                                                                                                                                                                                                                                                    
ASHWIN     SAT        NO                                                                                                                                                                                                                                                                                    
ASHWIN     GRE        NO                                                                                                                                                                                                                                                                                    
SARITA     TOEFL      NO                                                                                                                                                                                                                                                                                    
SARITA     GMAT       NO                                                                                                                                                                                                                                                                                    
SARITA     SAT        NO                                                                                                                                                                                                                                                                                    
SARITA     GRE        NO                                                                                                                                                                                                                                                                                    
BIMAL      TOEFL      NO                                                                                                                                                                                                                                                                                    
BIMAL      GMAT       NO                                                                                                                                                                                                                                                                                    
BIMAL      SAT        NO                                                                                                                                                                                                                                                                                    
BIMAL      GRE        NO                                                                                                                                                                                                                                                                                    

12 rows selected.

SQL> SELECT T.NAME STAFF , B.NAME SUBJECT , 'NO ' CAN? FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B;
SELECT T.NAME STAFF , B.NAME SUBJECT , 'NO ' CAN? FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B
                                                *
ERROR at line 1:
ORA-00911: invalid character 


SQL> SELECT T.NAME STAFF , B.NAME SUBJECT , 'NO ' "CAN?" FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B;

STAFF      SUBJECT    CAN                                                                                                                                                                                                                                                                                   
---------- ---------- ---                                                                                                                                                                                                                                                                                   
ASHWIN     TOEFL      NO                                                                                                                                                                                                                                                                                    
ASHWIN     GMAT       NO                                                                                                                                                                                                                                                                                    
ASHWIN     SAT        NO                                                                                                                                                                                                                                                                                    
ASHWIN     GRE        NO                                                                                                                                                                                                                                                                                    
SARITA     TOEFL      NO                                                                                                                                                                                                                                                                                    
SARITA     GMAT       NO                                                                                                                                                                                                                                                                                    
SARITA     SAT        NO                                                                                                                                                                                                                                                                                    
SARITA     GRE        NO                                                                                                                                                                                                                                                                                    
BIMAL      TOEFL      NO                                                                                                                                                                                                                                                                                    
BIMAL      GMAT       NO                                                                                                                                                                                                                                                                                    
BIMAL      SAT        NO                                                                                                                                                                                                                                                                                    
BIMAL      GRE        NO                                                                                                                                                                                                                                                                                    

12 rows selected.

SQL> SELECT T.NAME STAFF , B.NAME SUBJECT , 'NO  ' "CAN?" FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B;

STAFF      SUBJECT    CAN?                                                                                                                                                                                                                                                                                  
---------- ---------- ----                                                                                                                                                                                                                                                                                  
ASHWIN     TOEFL      NO                                                                                                                                                                                                                                                                                    
ASHWIN     GMAT       NO                                                                                                                                                                                                                                                                                    
ASHWIN     SAT        NO                                                                                                                                                                                                                                                                                    
ASHWIN     GRE        NO                                                                                                                                                                                                                                                                                    
SARITA     TOEFL      NO                                                                                                                                                                                                                                                                                    
SARITA     GMAT       NO                                                                                                                                                                                                                                                                                    
SARITA     SAT        NO                                                                                                                                                                                                                                                                                    
SARITA     GRE        NO                                                                                                                                                                                                                                                                                    
BIMAL      TOEFL      NO                                                                                                                                                                                                                                                                                    
BIMAL      GMAT       NO                                                                                                                                                                                                                                                                                    
BIMAL      SAT        NO                                                                                                                                                                                                                                                                                    
BIMAL      GRE        NO                                                                                                                                                                                                                                                                                    

12 rows selected.

SQL> SELECT T.NAME STAFF , B.NAME SUBJECT , 'NO  ' "CAN?" FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B
  2  MINUS
  3  SELECT STAFF , SUBJECT , 'NO  ' FROM MPSCANTEACH;

STAFF      SUBJECT    CAN?                                                                                                                                                                                                                                                                                  
---------- ---------- ----                                                                                                                                                                                                                                                                                  
ASHWIN     GMAT       NO                                                                                                                                                                                                                                                                                    
ASHWIN     SAT        NO                                                                                                                                                                                                                                                                                    
BIMAL      GMAT       NO                                                                                                                                                                                                                                                                                    
BIMAL      GRE        NO                                                                                                                                                                                                                                                                                    
BIMAL      TOEFL      NO                                                                                                                                                                                                                                                                                    
SARITA     GRE        NO                                                                                                                                                                                                                                                                                    
SARITA     SAT        NO                                                                                                                                                                                                                                                                                    
SARITA     TOEFL      NO                                                                                                                                                                                                                                                                                    

8 rows selected.

SQL> SELECT STAFF , SUBJECT FROM MPSCANTEACH;

STAFF      SUBJECT                                                                                                                                                                                                                                                                                          
---------- ----------                                                                                                                                                                                                                                                                                       
ASHWIN     TOEFL                                                                                                                                                                                                                                                                                            
ASHWIN     GRE                                                                                                                                                                                                                                                                                              
SARITA     GMAT                                                                                                                                                                                                                                                                                             
BIMAL      SAT                                                                                                                                                                                                                                                                                              

SQL> SELECT T.NAME STAFF , B.NAME SUBJECT , 'NO  ' "CAN?" FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B
  2  MINUS
  3  SELECT STAFF , SUBJECT , 'NO  ' FROM MPSCANTEACH
  4  UNION
  5  SELECT STAFF , SUBJECT , 'YES ' FROM MPSCANTEACH;

STAFF      SUBJECT    CAN?                                                                                                                                                                                                                                                                                  
---------- ---------- ----                                                                                                                                                                                                                                                                                  
ASHWIN     GMAT       NO                                                                                                                                                                                                                                                                                    
ASHWIN     GRE        YES                                                                                                                                                                                                                                                                                   
ASHWIN     SAT        NO                                                                                                                                                                                                                                                                                    
ASHWIN     TOEFL      YES                                                                                                                                                                                                                                                                                   
BIMAL      GMAT       NO                                                                                                                                                                                                                                                                                    
BIMAL      GRE        NO                                                                                                                                                                                                                                                                                    
BIMAL      SAT        YES                                                                                                                                                                                                                                                                                   
BIMAL      TOEFL      NO                                                                                                                                                                                                                                                                                    
SARITA     GMAT       YES                                                                                                                                                                                                                                                                                   
SARITA     GRE        NO                                                                                                                                                                                                                                                                                    
SARITA     SAT        NO                                                                                                                                                                                                                                                                                    
SARITA     TOEFL      NO                                                                                                                                                                                                                                                                                    

12 rows selected.

SQL> SELECT T.NAME STAFF , B.NAME SUBJECT ,
  2  (CASE WHEN (STAFF , SUBJECT) IN (SELECT * FROM MPSCANTEACH) THEN 'YES ' ELSE 'NO  ' END)
  3  
SQL> SELECT T.NAME STAFF , B.NAME SUBJECT ,
  2  (CASE WHEN (STAFF , SUBJECT) IN (SELECT * FROM MPSCANTEACH) THEN 'YES ' ELSE 'NO  ' END) "CAN?"
  3  FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B;
(CASE WHEN (STAFF , SUBJECT) IN (SELECT * FROM MPSCANTEACH) THEN 'YES ' ELSE 'NO  ' END) "CAN?"
                    *
ERROR at line 2:
ORA-00904: "SUBJECT": invalid identifier 


SQL> ED
Wrote file afiedt.buf

  1  SELECT T.NAME STAFF , B.NAME SUBJECT ,
  2  (CASE WHEN (T.NAME , B.NAME) IN (SELECT * FROM MPSCANTEACH) THEN 'YES ' ELSE 'NO  ' END) "CAN?"
  3* FROM MPSSTAFF T CROSS JOIN MPSSUBJECT B
SQL> /

STAFF      SUBJECT    CAN?                                                                                                                                                                                                                                                                                  
---------- ---------- ----                                                                                                                                                                                                                                                                                  
ASHWIN     TOEFL      YES                                                                                                                                                                                                                                                                                   
ASHWIN     GMAT       NO                                                                                                                                                                                                                                                                                    
ASHWIN     SAT        NO                                                                                                                                                                                                                                                                                    
ASHWIN     GRE        YES                                                                                                                                                                                                                                                                                   
SARITA     TOEFL      NO                                                                                                                                                                                                                                                                                    
SARITA     GMAT       YES                                                                                                                                                                                                                                                                                   
SARITA     SAT        NO                                                                                                                                                                                                                                                                                    
SARITA     GRE        NO                                                                                                                                                                                                                                                                                    
BIMAL      TOEFL      NO                                                                                                                                                                                                                                                                                    
BIMAL      GMAT       NO                                                                                                                                                                                                                                                                                    
BIMAL      SAT        YES                                                                                                                                                                                                                                                                                   
BIMAL      GRE        NO                                                                                                                                                                                                                                                                                    

12 rows selected.

SQL> SPOOL OFF
